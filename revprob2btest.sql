SELECT 
  LINE_TYPE,
  CUSTOMER_NAME,
  CUSTOMER_NUM,
  SFDC_CONTRACT_ID,
  SALES_ORDER_NUM,
  SALES_ORDER_LINE_NUM,
  SALES_ORDER_LINE_ID,
  to_varchar(SALES_ORDER_DATE,'MM/DD/YYYY') AS SALES_ORDER_DATE,
  ORDERED_QTY,
  INVOICE_NUM,
  INVOICE_LINE_NUM,
  INVOICE_LINE_ID,
  to_varchar(INVOICE_DATE,'MM/DD/YYYY') AS INVOICE_DATE,
  INVOICE_QTY,
  RET_QTY,
  LINE_ITEM_NUM,
  to_varchar(REV_START,'MM/DD/YYYY') AS REV_START,
  to_varchar(REV_END,'MM/DD/YYYY') AS REV_END,
  EXT_LIST_PRICE,
  EXT_SELL_PRICE,
  TRANS_CURR,
  FUNCT_EX_RATE,
  FUNCT_CURR,
  GLOBAL_EX_RATE,
  DEF_SEG,
  REV_SEG,
  ADJUST_LIAB_ACCOUNT,
  ADJUST_REV_ACCOUNT,
  LT_CONTRACT_LIAB,
  LT_ADJUST_LIAB,
  DEF_OFFSET_SEG,
  UNBILLED_AR_ACCOUNT,
  CONTRACT_ASSET_ACCOUNT,
  RC_CV_ELIGIBLE_FLAG,
  to_varchar(FV_DATE,'MM/DD/YYYY') AS FV_DATE,
  ORIG_INV_LINE_ID,
  ORIG_SO_LINE_ID,
  PRODUCT_FAMILY,
  PRODUCT_LINE,
  PRODUCT_CATEGORY,
  RIGHT_TO_BILL,
  UNIT_LIST_PRICE,
  UNIT_SELL_PRICE,
  DATA_SOURCE,
  UBB_FLAG,
  REF_NUM,
  LICENSE_TYPE,
  NO_OF_DEVICES,
  POB_IDENTIFIER,
  KEY,
  NETSUITE_ITEM_INTERNAL_ID,
  TERM,
  CLASS,
  LOCATION,
  DEPARTMENT,
  DISCOUNT_AMOUNT,
  BUYER_PRICE_GROSS,
  BUYER_PRICE_NET,
  EXCHANGE_RATE_TO_USD,
  REVENUE_ARRANGEMENT,
  to_varchar(RC_LINE_DATE1,'MM/DD/YYYY') AS  RC_LINE_DATE1,
  to_varchar(RC_LINE_DATE2,'MM/DD/YYYY') AS  RC_LINE_DATE2,
  to_varchar(RC_LINE_DATE3,'MM/DD/YYYY') AS  RC_LINE_DATE3,
  to_varchar(RC_LINE_DATE4,'MM/DD/YYYY') AS  RC_LINE_DATE4,
  to_varchar(RC_LINE_DATE5,'MM/DD/YYYY') AS  RC_LINE_DATE5,
  CPQ_MULTIPLIER,
  RC_ID,
  BILL_COMPANY,
  BILLADDRESS,
  BILL_COUNTRY,
  BILL_CITY,
  BILL_STATE,
  BILL_ZIP,
  SHIP_COMPANY,
  SHIPADDRESS,
  SHIP_COUNTRY,
  SHIP_CITY,
  SHIP_STATE,
  SHIP_ZIP,
  SUBSIDIARY,
  CONTRAARACCOUNT,
  SUBSCRIPTION_REFERENCE_NUMBER,
  BUYER_CURRENCY,
  MEMO,
  SUBSCRIPTION,
  SOURCE_SYSTEM,
  LIST_PRICE,
  RC_LINE_ATR46,
  GROSS_ORDER_VALUE,
  DEFAULT_SUBSCRIPTION_TERM,
  CREDIT_RULE,
  REVPRO_TERM
  FROM "CDS_STG"."CDS"."MWB_REVPRO_B2B_NO_ONLINEPROMO_CDS"
WHERE ((LINE_TYPE IN ('INV', 'CM') AND date(invoice_date) BETWEEN '2023-06-01' AND '2023-06-30')
       OR (LINE_TYPE ='SO' AND date(SALES_ORDER_DATE) BETWEEN '2023-06-01' AND '2023-06-30'))
ORDER BY to_date(sales_order_date), to_date(invoice_date) ASC;
